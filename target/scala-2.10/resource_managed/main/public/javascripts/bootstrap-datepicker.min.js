!function($){var Datepicker=function(element,options){this.element=$(element);this.format=DPGlobal.parseFormat(options.format||this.element.data("date-format")||"mm/dd/yyyy");this.picker=$(DPGlobal.template).appendTo("body").on({click:$.proxy(this.click,this)});this.isInput=this.element.is("input");this.component=this.element.is(".date")?this.element.find(".add-on"):false;if(this.isInput)this.element.on({focus:$.proxy(this.show,this),keyup:$.proxy(this.update,this)});else if(this.component)this.component.on("click",
$.proxy(this.show,this));else this.element.on("click",$.proxy(this.show,this));this.minViewMode=options.minViewMode||this.element.data("date-minviewmode")||0;if(typeof this.minViewMode==="string")switch(this.minViewMode){case "months":this.minViewMode=1;break;case "years":this.minViewMode=2;break;default:this.minViewMode=0;break}this.viewMode=options.viewMode||this.element.data("date-viewmode")||0;if(typeof this.viewMode==="string")switch(this.viewMode){case "months":this.viewMode=1;break;case "years":this.viewMode=
2;break;default:this.viewMode=0;break}this.startViewMode=this.viewMode;this.weekStart=options.weekStart||this.element.data("date-weekstart")||0;this.weekEnd=this.weekStart===0?6:this.weekStart-1;this.onRender=options.onRender;this.fillDow();this.fillMonths();this.update();this.showMode()};Datepicker.prototype={constructor:Datepicker,show:function(e){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();$(window).on("resize",$.proxy(this.place,
this));if(e){e.stopPropagation();e.preventDefault()}if(!this.isInput);var that=this;$(document).on("mousedown",function(ev){if($(ev.target).closest(".datepicker").length==0)that.hide()});this.element.trigger({type:"show",date:this.date})},hide:function(){this.picker.hide();$(window).off("resize",this.place);this.viewMode=this.startViewMode;this.showMode();if(!this.isInput)$(document).off("mousedown",this.hide);this.element.trigger({type:"hide",date:this.date})},set:function(){var formated=DPGlobal.formatDate(this.date,
this.format);if(!this.isInput){if(this.component)this.element.find("input").prop("value",formated);this.element.data("date",formated)}else this.element.prop("value",formated)},setValue:function(newDate){if(typeof newDate==="string")this.date=DPGlobal.parseDate(newDate,this.format);else this.date=new Date(newDate);this.set();this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0);this.fill()},place:function(){var offset=this.component?this.component.offset():this.element.offset();
this.picker.css({top:offset.top+this.height,left:offset.left})},update:function(newDate){this.date=DPGlobal.parseDate(typeof newDate==="string"?newDate:this.isInput?this.element.prop("value"):this.element.data("date"),this.format);this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0);this.fill()},fillDow:function(){var dowCnt=this.weekStart;for(var html="\x3ctr\x3e";dowCnt<this.weekStart+7;)html+='\x3cth class\x3d"dow"\x3e'+DPGlobal.dates.daysMin[dowCnt++%7]+"\x3c/th\x3e";
html+="\x3c/tr\x3e";this.picker.find(".datepicker-days thead").append(html)},fillMonths:function(){var html="";for(var i=0;i<12;)html+='\x3cspan class\x3d"month"\x3e'+DPGlobal.dates.monthsShort[i++]+"\x3c/span\x3e";this.picker.find(".datepicker-months td").append(html)},fill:function(){var d=new Date(this.viewDate);var year=d.getFullYear();var month=d.getMonth();var currentDate=this.date.valueOf();this.picker.find(".datepicker-days th:eq(1)").text(DPGlobal.dates.months[month]+" "+year);var prevMonth=
new Date(year,month-1,28,0,0,0,0);var day=DPGlobal.getDaysInMonth(prevMonth.getFullYear(),prevMonth.getMonth());prevMonth.setDate(day);prevMonth.setDate(day-(prevMonth.getDay()-this.weekStart+7)%7);var nextMonth=new Date(prevMonth);nextMonth.setDate(nextMonth.getDate()+42);nextMonth=nextMonth.valueOf();var html=[];var clsName;var prevY;for(var prevM;prevMonth.valueOf()<nextMonth;){if(prevMonth.getDay()===this.weekStart)html.push("\x3ctr\x3e");clsName=this.onRender(prevMonth);prevY=prevMonth.getFullYear();
prevM=prevMonth.getMonth();if(prevM<month&&prevY===year||prevY<year)clsName+=" old";else if(prevM>month&&prevY===year||prevY>year)clsName+=" new";if(prevMonth.valueOf()===currentDate)clsName+=" active";html.push('\x3ctd class\x3d"day '+clsName+'"\x3e'+prevMonth.getDate()+"\x3c/td\x3e");if(prevMonth.getDay()===this.weekEnd)html.push("\x3c/tr\x3e");prevMonth.setDate(prevMonth.getDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(html.join(""));var currentYear=this.date.getFullYear();
var months=this.picker.find(".datepicker-months").find("th:eq(1)").text(year).end().find("span").removeClass("active");if(currentYear===year)months.eq(this.date.getMonth()).addClass("active");html="";year=parseInt(year/10,10)*10;var yearCont=this.picker.find(".datepicker-years").find("th:eq(1)").text(year+"-"+(year+9)).end().find("td");year-=1;for(var i=-1;i<11;i++){html+='\x3cspan class\x3d"year'+(i===-1||i===10?" old":"")+(currentYear===year?" active":"")+'"\x3e'+year+"\x3c/span\x3e";year+=1}yearCont.html(html)},
click:function(e){e.stopPropagation();e.preventDefault();var target=$(e.target).closest("span, td, th");if(target.length===1)switch(target[0].nodeName.toLowerCase()){case "th":switch(target[0].className){case "switch":this.showMode(1);break;case "prev":case "next":this.viewDate["set"+DPGlobal.modes[this.viewMode].navFnc].call(this.viewDate,this.viewDate["get"+DPGlobal.modes[this.viewMode].navFnc].call(this.viewDate)+DPGlobal.modes[this.viewMode].navStep*(target[0].className==="prev"?-1:1));this.fill();
this.set();break}break;case "span":if(target.is(".month")){var month=target.parent().find("span").index(target);this.viewDate.setMonth(month)}else{var year=parseInt(target.text(),10)||0;this.viewDate.setFullYear(year)}if(this.viewMode!==0){this.date=new Date(this.viewDate);this.element.trigger({type:"changeDate",date:this.date,viewMode:DPGlobal.modes[this.viewMode].clsName})}this.showMode(-1);this.fill();this.set();break;case "td":if(target.is(".day")&&!target.is(".disabled")){var day=parseInt(target.text(),
10)||1;month=this.viewDate.getMonth();if(target.is(".old"))month-=1;else if(target.is(".new"))month+=1;year=this.viewDate.getFullYear();this.date=new Date(year,month,day,0,0,0,0);this.viewDate=new Date(year,month,Math.min(28,day),0,0,0,0);this.fill();this.set();this.element.trigger({type:"changeDate",date:this.date,viewMode:DPGlobal.modes[this.viewMode].clsName})}break}},mousedown:function(e){e.stopPropagation();e.preventDefault()},showMode:function(dir){if(dir)this.viewMode=Math.max(this.minViewMode,
Math.min(2,this.viewMode+dir));this.picker.find("\x3ediv").hide().filter(".datepicker-"+DPGlobal.modes[this.viewMode].clsName).show()}};$.fn.datepicker=function(option,val){return this.each(function(){var $this=$(this);var data=$this.data("datepicker");var options=typeof option==="object"&&option;if(!data)$this.data("datepicker",data=new Datepicker(this,$.extend({},$.fn.datepicker.defaults,options)));if(typeof option==="string")data[option](val)})};$.fn.datepicker.defaults={onRender:function(date){return""}};
$.fn.datepicker.Constructor=Datepicker;var DPGlobal={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],dates:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November",
"December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},isLeapYear:function(year){return year%4===0&&year%100!==0||year%400===0},getDaysInMonth:function(year,month){return[31,DPGlobal.isLeapYear(year)?29:28,31,30,31,30,31,31,30,31,30,31][month]},parseFormat:function(format){var separator=format.match(/[.\/\-\s].*?/);var parts=format.split(/\W+/);if(!separator||!parts||parts.length===0)throw new Error("Invalid date format.");return{separator:separator,parts:parts}},
parseDate:function(date,format){var parts=date.split(format.separator);date=new Date;var val;date.setHours(0);date.setMinutes(0);date.setSeconds(0);date.setMilliseconds(0);if(parts.length===format.parts.length){var year=date.getFullYear();var day=date.getDate();var month=date.getMonth();var i=0;for(var cnt=format.parts.length;i<cnt;i++){val=parseInt(parts[i],10)||1;switch(format.parts[i]){case "dd":case "d":day=val;date.setDate(val);break;case "mm":case "m":month=val-1;date.setMonth(val-1);break;
case "yy":year=2E3+val;date.setFullYear(2E3+val);break;case "yyyy":year=val;date.setFullYear(val);break}}date=new Date(year,month,day,0,0,0)}return date},formatDate:function(date,format){var val={d:date.getDate(),m:date.getMonth()+1,yy:date.getFullYear().toString().substring(2),yyyy:date.getFullYear()};val.dd=(val.d<10?"0":"")+val.d;val.mm=(val.m<10?"0":"")+val.m;date=[];var i=0;for(var cnt=format.parts.length;i<cnt;i++)date.push(val[format.parts[i]]);return date.join(format.separator)},headTemplate:"\x3cthead\x3e"+
"\x3ctr\x3e"+'\x3cth class\x3d"prev"\x3e\x26lsaquo;\x3c/th\x3e'+'\x3cth colspan\x3d"5" class\x3d"switch"\x3e\x3c/th\x3e'+'\x3cth class\x3d"next"\x3e\x26rsaquo;\x3c/th\x3e'+"\x3c/tr\x3e"+"\x3c/thead\x3e",contTemplate:'\x3ctbody\x3e\x3ctr\x3e\x3ctd colspan\x3d"7"\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e'};DPGlobal.template='\x3cdiv class\x3d"datepicker dropdown-menu"\x3e'+'\x3cdiv class\x3d"datepicker-days"\x3e'+'\x3ctable class\x3d" table-condensed"\x3e'+DPGlobal.headTemplate+"\x3ctbody\x3e\x3c/tbody\x3e"+
"\x3c/table\x3e"+"\x3c/div\x3e"+'\x3cdiv class\x3d"datepicker-months"\x3e'+'\x3ctable class\x3d"table-condensed"\x3e'+DPGlobal.headTemplate+DPGlobal.contTemplate+"\x3c/table\x3e"+"\x3c/div\x3e"+'\x3cdiv class\x3d"datepicker-years"\x3e'+'\x3ctable class\x3d"table-condensed"\x3e'+DPGlobal.headTemplate+DPGlobal.contTemplate+"\x3c/table\x3e"+"\x3c/div\x3e"+"\x3c/div\x3e"}(window.jQuery);(function(){$(function(){jsRoutes.controllers.FinanceFolderController.listFolders().ajax({success:function(data){addFolders(data,"GET")}})});$(function(){var form=$("#newFolder");form.on("submit",function(e){e.preventDefault();jsRoutes.controllers.FinanceFolderController.addFolder().ajax({data:form.serialize(),success:function(data){addFolders(data,"POST",form)},error:function(data){alert("error adding folder")}})})});$(function(){var form=$("#newTransaction");form.on("submit",function(e){e.preventDefault();
var selectedFolder=$(".selected .folder-name");if(selectedFolder.length!=0)jsRoutes.controllers.TransactionController.addTransaction(selectedFolder[0].innerHTML).ajax({data:{amount:parseFloat($("input[name\x3damount]",form).val()),shortDescription:$("input[name\x3dshortDescription]",form).val(),creationDate:$("input[name\x3ddate]",form).val()},success:function(data){var html="\x3cdiv class\x3d'transaction'\x3e"+"\x3cspan class\x3d'transDate'\x3e"+$("input[name\x3ddate]",form).val()+"\x3c/span\x3e \x3cspan class\x3d'transDescript'\x3e"+
data.shortDescription+"\x3c/span\x3e\x3cspan class\x3d'transAmount'\x3e"+data.amount+"\x3c/span\x3e\x3c/div\x3e";$("#transaction-list").append(html);var selected=$(".selected .folder-total")[0];var oldTotal=parseFloat(selected.innerHTML);selected.innerHTML=oldTotal+data.amount;for(var i=0;i<form.length;i++)form[i].reset()},error:function(data){alert("cannot add transaction")}});else alert("A folder must be selected before adding transactions")})});$(function(){$("#folder-list").on("click",".folder",
function(event){var selected=$(".selected");if(this!=selected[0]){selected.removeClass("selected");$(this).addClass("selected");addTransactions($(".selected .folder-name")[0].innerHTML)}})})}).call(this);
var addFolders=function(data,inputType,form){var html=[];if(inputType=="GET")$.each(data,function(i,folder){html.push("\x3cdiv class\x3d'folder'\x3e "+"\x3cspan class\x3d'folder-name'\x3e"+folder.name+"\x3c/span\x3e"+"\x3cspan class\x3d'folder-total'\x3e"+folder.total+"\x3c/span\x3e \x3c/div\x3e")});else if(inputType=="POST"){html.push("\x3cdiv class\x3d'folder'\x3e "+"\x3cspan class\x3d'folder-name'\x3e"+$("input[name\x3dname]",form).val()+"\x3c/span\x3e"+"\x3cspan class\x3d'folder-total'\x3e"+0+
"\x3c/span\x3e \x3c/div\x3e");form[0].reset()}$("#folder-list").append(html.join(""))};
var addTransactions=function(folder){$(function(){jsRoutes.controllers.TransactionController.listTransactions(folder).ajax({success:function(data){var html=[];$.each(data,function(i,transaction){var date=new Date(transaction.creationDate);html.push("\x3cdiv class\x3d'transaction'\x3e"+"\x3cspan class\x3d'transDate'\x3e"+(date.getUTCMonth()+1)+"/"+date.getUTCDate()+"/"+date.getUTCFullYear()+"\x3c/span\x3e \x3cspan class\x3d'transDescript'\x3e"+transaction.shortDescription+"\x3c/span\x3e\x3cspan class\x3d'transAmount'\x3e"+
transaction.amount+"\x3c/span\x3e\x3c/div\x3e")});$("#transaction-list").html(html.join(""))}})})};